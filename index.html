<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SIP Calculator - Modern UI</title>
    
    <style>
        /* --- MODERN UI STYLES --- */
        :root {
            --bg-dark-slate: #111827;
            --bg-slate: #1f2937;
            --bg-light-slate: #374151;
            --border-slate: #4b5563;
            --text-light-gray: #d1d5db;
            --text-gray: #9ca3af;
            --accent-blue: #3b82f6;
            --accent-green: #22c55e;
            --accent-teal: #14b8a6;
            --accent-glow: rgba(59, 130, 246, 0.5);
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(170deg, var(--bg-dark-slate), #0d121c);
            color: var(--text-light-gray);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            margin: 0;
            display: flex;
            justify-content: center;
            min-height: 100vh;
        }

        .container {
            width: 100%;
            max-width: 500px;
            padding: 1rem;
            box-sizing: border-box;
            animation: fadeIn 0.5s ease-out;
        }

        header {
            text-align: center;
            padding-bottom: 2rem;
        }
        header h1 {
            font-size: 2rem;
            font-weight: 800;
            color: white;
            letter-spacing: -0.025em;
            margin: 0;
        }
        header p {
            color: var(--text-gray);
            margin-top: 0.5rem;
        }

        .tabs-container {
            background-color: var(--bg-slate);
            border-radius: 0.75rem;
            padding: 0.25rem;
            display: flex;
            position: relative;
        }
        .tab-btn {
            flex: 1;
            padding: 0.75rem 0;
            border: none;
            background: none;
            color: var(--text-gray);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            position: relative;
            z-index: 2;
            transition: color 0.3s ease;
        }
        .tab-btn.active {
            color: white;
        }
        .tab-highlight {
            position: absolute;
            top: 0.25rem;
            bottom: 0.25rem;
            width: calc(50% - 0.25rem);
            background-color: var(--accent-blue);
            border-radius: 0.5rem;
            transition: transform 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }

        main {
            background-color: var(--bg-slate);
            border-radius: 1rem;
            margin-top: 1.5rem;
            padding: 1.5rem;
        }
        
        .input-block { margin-bottom: 2rem; }
        .input-block:last-child { margin-bottom: 0; }

        .label-group {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            margin-bottom: 1rem;
        }
        .label-group label {
            font-weight: 500;
            color: var(--text-light-gray);
        }
        .input-value {
            font-size: 1.25rem;
            font-weight: 600;
            color: white;
        }
        .input-value-small {
            font-size: 1rem;
            color: var(--text-light-gray);
        }

        input[type="range"] {
            -webkit-appearance: none; appearance: none;
            width: 100%; height: 8px; background: var(--bg-dark-slate);
            border-radius: 4px; outline: none; transition: background 0.2s;
        }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none; appearance: none;
            width: 22px; height: 22px; background: white;
            cursor: pointer; border-radius: 50%;
            border: 5px solid var(--accent-blue);
            transition: transform 0.2s ease;
        }
        input[type="range"]:active::-webkit-slider-thumb {
            transform: scale(1.1);
        }
        input[type="range"]::-moz-range-thumb {
            width: 12px; height: 12px; background: white;
            cursor: pointer; border-radius: 50%;
            border: 5px solid var(--accent-blue);
        }
        
        .number-input-wrapper {
            background-color: var(--bg-dark-slate);
            border-radius: 0.5rem;
            padding: 0.25rem 0.75rem;
            border: 1px solid var(--border-slate);
            transition: border-color 0.2s, box-shadow 0.2s;
        }
        .number-input-wrapper:focus-within {
            border-color: var(--accent-blue);
            box-shadow: 0 0 0 3px var(--accent-glow);
        }
        input[type="number"] {
            background: none; border: none; outline: none;
            color: white; font-weight: 600; font-size: 1.125rem;
            text-align: right; width: 100%;
             -moz-appearance: textfield;
        }
        input[type="number"]::-webkit-outer-spin-button,
        input[type="number"]::-webkit-inner-spin-button {
             -webkit-appearance: none; margin: 0;
        }

        .results-section {
            background: linear-gradient(135deg, var(--bg-slate), #222c3d);
            border-radius: 1rem;
            padding: 1.5rem;
            margin-top: 1.5rem;
        }
        .result-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 0;
        }
        .result-row span:first-child { color: var(--text-gray); }
        .result-row span:last-child { font-weight: 600; font-size: 1.1rem; }
        hr { border: 0; border-top: 1px solid var(--border-slate); margin: 1rem 0; }
        .total-value-row span:first-child { font-size: 1.1rem; color: var(--text-light-gray); }
        .total-value-row span:last-child {
            font-size: 2rem;
            font-weight: 800;
            color: var(--accent-green);
        }
        
        .chart-section {
             background-color: var(--bg-slate);
             border-radius: 1rem;
             margin-top: 1.5rem;
             padding: 1rem;
        }

        .hidden { display: none; }
    </style>
</head>
<body>

    <div class="container">

        <header>
            <h1>SIP Calculator</h1>
            <p>Visualize Your Wealth Creation Journey</p>
        </header>

        <div class="tabs-container">
            <div id="tabHighlight" class="tab-highlight"></div>
            <button id="sipTab" class="tab-btn active">SIP</button>
            <button id="lumpsumTab" class="tab-btn">Lump Sum</button>
        </div>

        <main>
            <!-- SIP Content -->
            <div id="sipContent">
                <div class="input-block">
                    <div class="label-group">
                        <label for="monthlyInvestment">Monthly Investment</label>
                        <div class="number-input-wrapper" style="width: 130px;">
                            <span style="color: var(--text-gray); font-weight: 600;">₹</span>
                            <input type="number" id="monthlyInvestmentInput" value="10000">
                        </div>
                    </div>
                    <input type="range" id="monthlyInvestment" min="500" max="100000" step="500" value="10000">
                </div>
                <div class="input-block">
                    <div class="label-group">
                        <label>Expected Return (p.a.)</label>
                        <span class="input-value"><span id="returnRateSipValue">12</span>%</span>
                    </div>
                    <input type="range" id="returnRateSip" min="1" max="30" step="0.5" value="12">
                </div>
                <div class="input-block">
                    <div class="label-group">
                        <label>Time Period</label>
                        <span class="input-value"><span id="timePeriodSipValue">10</span> <span class="input-value-small">Years</span></span>
                    </div>
                    <input type="range" id="timePeriodSip" min="1" max="40" step="1" value="10">
                </div>
            </div>

            <!-- Lumpsum Content -->
            <div id="lumpsumContent" class="hidden">
                <div class="input-block">
                     <div class="label-group">
                        <label for="lumpsum">Total Investment</label>
                        <div class="number-input-wrapper" style="width: 150px;">
                             <span style="color: var(--text-gray); font-weight: 600;">₹</span>
                            <input type="number" id="lumpsumInput" value="500000">
                        </div>
                    </div>
                    <input type="range" id="lumpsum" min="10000" max="5000000" step="10000" value="500000">
                </div>
                <div class="input-block">
                    <div class="label-group">
                        <label>Expected Return (p.a.)</label>
                        <span class="input-value"><span id="returnRateLumpsumValue">12</span>%</span>
                    </div>
                    <input type="range" id="returnRateLumpsum" min="1" max="30" step="0.5" value="12">
                </div>
                 <div class="input-block">
                    <div class="label-group">
                        <label>Time Period</label>
                        <span class="input-value"><span id="timePeriodLumpsumValue">10</span> <span class="input-value-small">Years</span></span>
                    </div>
                    <input type="range" id="timePeriodLumpsum" min="1" max="40" step="1" value="10">
                </div>
            </div>
        </main>

        <section class="results-section">
            <div class="result-row">
                <span>Invested Amount</span>
                <span id="investedAmount">₹ 0</span>
            </div>
            <div class="result-row">
                <span>Estimated Returns</span>
                <span id="estimatedReturns" style="color: var(--accent-green);">₹ 0</span>
            </div>
            <hr>
            <div class="result-row total-value-row">
                <span>Total Value</span>
                <span id="totalValue">₹ 0</span>
            </div>
        </section>

        <section class="chart-section">
            <div id="investmentChartContainer" style="height: 250px; width: 100%;"></div>
        </section>

    </div>

    <script>
        (() => {
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', initializeCalculator);
            } else {
                initializeCalculator();
            }

            function initializeCalculator() {
                try {
                    const elements = {
                        sipTab: document.getElementById('sipTab'),
                        lumpsumTab: document.getElementById('lumpsumTab'),
                        tabHighlight: document.getElementById('tabHighlight'),
                        sipContent: document.getElementById('sipContent'),
                        lumpsumContent: document.getElementById('lumpsumContent'),
                        monthlyInvestmentSlider: document.getElementById('monthlyInvestment'),
                        monthlyInvestmentInput: document.getElementById('monthlyInvestmentInput'),
                        returnRateSipSlider: document.getElementById('returnRateSip'),
                        timePeriodSipSlider: document.getElementById('timePeriodSip'),
                        returnRateSipValue: document.getElementById('returnRateSipValue'),
                        timePeriodSipValue: document.getElementById('timePeriodSipValue'),
                        lumpsumSlider: document.getElementById('lumpsum'),
                        lumpsumInput: document.getElementById('lumpsumInput'),
                        returnRateLumpsumSlider: document.getElementById('returnRateLumpsum'),
                        timePeriodLumpsumSlider: document.getElementById('timePeriodLumpsum'),
                        returnRateLumpsumValue: document.getElementById('returnRateLumpsumValue'),
                        timePeriodLumpsumValue: document.getElementById('timePeriodLumpsumValue'),
                        investedAmountEl: document.getElementById('investedAmount'),
                        estimatedReturnsEl: document.getElementById('estimatedReturns'),
                        totalValueEl: document.getElementById('totalValue'),
                        chartContainer: document.getElementById('investmentChartContainer')
                    };
                    let activeTab = 'sip';
                    const inrFormatter = new Intl.NumberFormat('en-IN', {
                        style: 'currency', currency: 'INR', minimumFractionDigits: 0, maximumFractionDigits: 0,
                    });

                    function updateCalculations() {
                        try {
                            elements.returnRateSipValue.textContent = elements.returnRateSipSlider.value;
                            elements.timePeriodSipValue.textContent = elements.timePeriodSipSlider.value;
                            elements.returnRateLumpsumValue.textContent = elements.returnRateLumpsumSlider.value;
                            elements.timePeriodLumpsumValue.textContent = elements.timePeriodLumpsumSlider.value;

                            let P = 0, L = 0, annualRate = 0, t = 0;

                            if (activeTab === 'sip') {
                                P = parseFloat(elements.monthlyInvestmentSlider.value) || 0;
                                annualRate = parseFloat(elements.returnRateSipSlider.value) || 0;
                                t = parseFloat(elements.timePeriodSipSlider.value) || 0;
                            } else {
                                L = parseFloat(elements.lumpsumSlider.value) || 0;
                                annualRate = parseFloat(elements.returnRateLumpsumSlider.value) || 0;
                                t = parseFloat(elements.timePeriodLumpsumSlider.value) || 0;
                            }

                            const n = t * 12;
                            const i = (annualRate / 100) / 12;
                            const sipFutureValue = (n > 0 && P > 0 && i > 0) ? P * (Math.pow(1 + i, n) - 1) / i * (1 + i) : (P * n);
                            const lumpsumFutureValue = (L > 0 && n > 0) ? L * Math.pow(1 + i, n) : L;
                            const totalValue = sipFutureValue + lumpsumFutureValue;
                            const totalInvestment = (P * n) + L;
                            const estimatedReturns = totalValue - totalInvestment;
                            
                            elements.investedAmountEl.textContent = inrFormatter.format(totalInvestment);
                            elements.estimatedReturnsEl.textContent = inrFormatter.format(estimatedReturns > 0 ? estimatedReturns : 0);
                            elements.totalValueEl.textContent = inrFormatter.format(totalValue > 0 ? totalValue : 0);
                            
                            updateSvgChart(P, L, annualRate, t);
                        } catch (error) {
                            console.error("Error during calculation update:", error);
                        }
                    }
                    
                    function switchTab(tab) {
                        activeTab = tab;
                        if (tab === 'sip') {
                            elements.sipTab.classList.add('active');
                            elements.lumpsumTab.classList.remove('active');
                            elements.tabHighlight.style.transform = 'translateX(0%)';
                            elements.sipContent.classList.remove('hidden');
                            elements.lumpsumContent.classList.add('hidden');
                        } else {
                            elements.lumpsumTab.classList.add('active');
                            elements.sipTab.classList.remove('active');
                            elements.tabHighlight.style.transform = 'translateX(100%)';
                            elements.lumpsumContent.classList.remove('hidden');
                            elements.sipContent.classList.add('hidden');
                        }
                        updateCalculations();
                    }
                    
                    function updateSvgChart(P, L, annualRate, t) {
                        try {
                            const container = elements.chartContainer;
                            const chartWidth = container.clientWidth;
                            const chartHeight = container.clientHeight;
                            if (chartWidth === 0 || chartHeight === 0) return;

                            const years = Array.from({ length: t + 1 }, (_, i) => i);
                            const investedData = [], valueData = [];
                            const monthlyRate = (annualRate / 100) / 12;

                            for (const year of years) {
                                const months = year * 12;
                                investedData.push((P * months) + L);
                                const currentSipValue = (months > 0 && P > 0 && monthlyRate > 0) ? P * (Math.pow(1 + monthlyRate, months) - 1) / monthlyRate * (1 + monthlyRate) : (P * months);
                                const currentLumpsumValue = (L > 0 && months > 0) ? L * Math.pow(1 + monthlyRate, months) : L;
                                valueData.push(currentSipValue + currentLumpsumValue);
                            }

                            const maxValue = Math.max(1, ...valueData);
                            const padding = { top: 20, right: 10, bottom: 30, left: 50 };

                            const xScale = (val) => padding.left + (t > 0 ? (val / t) : 0) * (chartWidth - padding.left - padding.right);
                            const yScale = (val) => (chartHeight - padding.bottom) - (val / maxValue) * (chartHeight - padding.bottom - padding.top);

                            const createPath = (data) => 'M' + years.map((y, i) => `${xScale(y).toFixed(2)} ${yScale(data[i]).toFixed(2)}`).join(' L');
                            
                            const valuePathData = createPath(valueData);
                            const investedPathData = createPath(investedData);

                            const areaPathData = valuePathData + ` L ${xScale(t).toFixed(2)} ${yScale(0).toFixed(2)} L ${xScale(0).toFixed(2)} ${yScale(0).toFixed(2)} Z`;

                            let yAxis = '', xAxis = '';
                            const formatYAxisLabel = (value) => {
                                if (value >= 10000000) return (value / 10000000).toFixed(1) + ' Cr';
                                if (value >= 100000) return (value / 100000).toFixed(1) + ' L';
                                if (value >= 1000) return (value / 1000).toFixed(0) + 'K';
                                return Math.round(value);
                            };
                            for (let i = 0; i <= 4; i++) {
                                const value = (maxValue / 4) * i;
                                const y = yScale(value);
                                yAxis += `<line x1="${padding.left}" y1="${y}" x2="${chartWidth - padding.right}" y2="${y}" stroke="var(--bg-light-slate)" stroke-dasharray="2,3" /><text x="${padding.left - 8}" y="${y + 4}" fill="var(--text-gray)" text-anchor="end" font-size="12">${formatYAxisLabel(value)}</text>`;
                            }
                            const xLabelCount = Math.min(t, 4);
                            if(t > 0) {
                                for (let i = 0; i <= xLabelCount; i++) {
                                    const year = Math.round((t / xLabelCount) * i);
                                    xAxis += `<text x="${xScale(year)}" y="${chartHeight - 5}" fill="var(--text-gray)" text-anchor="middle" font-size="12">${year}Y</text>`;
                                }
                            }

                            const svg = `
                                <svg width="100%" height="100%" viewBox="0 0 ${chartWidth} ${chartHeight}">
                                    <defs>
                                        <linearGradient id="areaGradient" x1="0" y1="0" x2="0" y2="1">
                                            <stop offset="0%" stop-color="var(--accent-green)" stop-opacity="0.2" />
                                            <stop offset="100%" stop-color="var(--accent-green)" stop-opacity="0" />
                                        </linearGradient>
                                    </defs>
                                    ${yAxis}
                                    ${xAxis}
                                    <path d="${investedPathData}" stroke="var(--accent-blue)" fill="none" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" />
                                    <path d="${areaPathData}" fill="url(#areaGradient)" />
                                    <path d="${valuePathData}" stroke="var(--accent-green)" fill="none" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" />
                                </svg>`;
                            container.innerHTML = svg;
                        } catch (error) {
                            console.error("Error drawing SVG chart:", error);
                            container.innerHTML = `<p style="color: var(--text-gray); text-align: center;">Chart is not available.</p>`;
                        }
                    }

                    function setupEventListeners() {
                        elements.sipTab.addEventListener('click', () => switchTab('sip'));
                        elements.lumpsumTab.addEventListener('click', () => switchTab('lumpsum'));

                        const allInputs = [
                            elements.monthlyInvestmentInput, elements.monthlyInvestmentSlider,
                            elements.returnRateSipSlider, elements.timePeriodSipSlider,
                            elements.lumpsumInput, elements.lumpsumSlider,
                            elements.returnRateLumpsumSlider, elements.timePeriodLumpsumSlider
                        ];
                        allInputs.forEach(input => input.addEventListener('input', updateCalculations));

                        const syncInputs = (inputEl, sliderEl) => {
                            inputEl.addEventListener('input', () => sliderEl.value = inputEl.value);
                            sliderEl.addEventListener('input', () => inputEl.value = sliderEl.value);
                            inputEl.addEventListener('blur', () => {
                                const min = parseFloat(sliderEl.min), max = parseFloat(sliderEl.max);
                                let value = Math.max(min, parseFloat(inputEl.value) || min);
                                if (value > max) value = max;
                                inputEl.value = value;
                                sliderEl.value = value;
                                updateCalculations();
                            });
                        };
                        syncInputs(elements.monthlyInvestmentInput, elements.monthlyInvestmentSlider);
                        syncInputs(elements.lumpsumInput, elements.lumpsumSlider);

                        let resizeTimeout;
                        window.addEventListener('resize', () => {
                            clearTimeout(resizeTimeout);
                            resizeTimeout = setTimeout(updateCalculations, 150);
                        });
                    }
                    
                    setupEventListeners();
                    switchTab('sip');

                } catch (error) {
                    console.error("Critical error on initialization:", error);
                    document.body.innerHTML = `<p style="color:red;padding:1rem;">A critical error occurred. The calculator cannot start.</p>`;
                }
            }
        })();
    </script>
</body>
</html>

